# CSV Test Data Samples

**Purpose**: Sample CSV files for testing CSV import and export functionality in PayPlan.

**Location**: `/test-data/csv-samples/`

## Test Scenarios

### 01-basic-payments.csv
**Purpose**: Happy path test with 3 standard payments
**Payments**: 3
**Risk Expected**: Auto-generated by PayPlan (may include COLLISION, WEEKEND_AUTOPAY)

**Use Case**: Basic CSV import → Build Plan → Export CSV → Verify round-trip

---

### 02-empty-risk-data.csv
**Purpose**: Verify empty risk data handling (FR-010)
**Payments**: 1
**Risk Expected**: None (scheduled far in future with no conflicts)

**Use Case**: Test that exported CSV has empty strings ("") in risk columns

---

### 03-special-characters.csv
**Purpose**: RFC 4180 escaping test (FR-006)
**Payments**: 3
**Special Cases**:
- Row 1: Provider name with comma: `"Klarna, Inc."`
- Row 2: Provider name with quotes: `"Bob's ""Best"" Buy"`
- Row 3: Provider name with newlines

**Use Case**: Test CSV escaping → Export → Open in Excel → Verify no corruption

---

### 04-unicode-characters.csv
**Purpose**: Unicode preservation test (FR-009)
**Payments**: 3
**Special Cases**:
- Row 1: Accented characters (Café Münchën)
- Row 2: Japanese characters (東京ストア)
- Row 3: Spanish accents (España)

**Use Case**: Test Unicode → Export → Open in spreadsheet → Verify characters preserved

---

### 05-edge-cases.csv
**Purpose**: Financial edge cases (CodeRabbit feedback)
**Payments**: 4
**Edge Cases**:
- Zero amount (0.00)
- Negative amount/refund (-25.50)
- Large amount (999999.99)
- Floating-point decimal (0.30)

**Use Case**: Test amount formatting accuracy → Export → Verify precision

---

### 06-multiple-providers.csv
**Purpose**: Realistic multi-provider scenario
**Payments**: 14
**Providers**: Klarna (3), Affirm (2), Afterpay (4), PayPal (3), Zip (1), Sezzle (1)

**Use Case**: Real-world test with multiple installments across providers

---

### 07-collision-risk.csv
**Purpose**: Test COLLISION risk detection
**Payments**: 4 (all due on same day: 2025-10-14)
**Risk Expected**: COLLISION risk with HIGH severity

**Use Case**: Verify risk columns populated in export

---

### 08-weekend-autopay.csv
**Purpose**: Test WEEKEND_AUTOPAY risk detection
**Payments**: 4 (all due on Saturday/Sunday with autopay=true)
**Dates**: Oct 18, 19, 25, 26 (Saturdays and Sundays)
**Risk Expected**: WEEKEND_AUTOPAY warnings

**Use Case**: Verify risk detection → Export with risk data

---

## Usage

### Import Testing
```bash
# From PayPlan UI
1. Navigate to Import page
2. Upload one of these CSV files
3. Click "Build Plan"
4. Verify expected behavior
```

### Export Testing
```bash
# After import
1. Process payments (Build Plan)
2. Click "Download CSV"
3. Compare exported CSV with expected format
4. Re-import exported CSV (round-trip test)
```

### Round-trip Testing
```bash
# Full workflow
1. Import: 01-basic-payments.csv
2. Build Plan
3. Export: payplan-export-YYYY-MM-DD-HHMMSS.csv
4. Re-import: exported CSV
5. Build Plan again
6. Compare results (should be identical)
```

## CSV Format Reference

### Import Format (Standard)
```csv
provider,installment_no,due_date,amount,currency,autopay,late_fee
Klarna,1,2025-10-02,45.00,USD,true,7
```

### Export Format (Enhanced)
```csv
provider,amount,currency,dueISO,autopay,risk_type,risk_severity,risk_message
Klarna,45.00,USD,2025-10-02,true,COLLISION,HIGH,"Multiple payments same day"
```

## Expected Behaviors

| File | Expected Risk | Empty Risk Columns | Special Handling |
|------|---------------|-------------------|------------------|
| 01-basic-payments | Yes (auto-detect) | No | Standard flow |
| 02-empty-risk-data | No | Yes ("") | Empty string test |
| 03-special-characters | Yes (auto-detect) | No | RFC 4180 escaping |
| 04-unicode-characters | Yes (auto-detect) | No | UTF-8 encoding |
| 05-edge-cases | Yes (auto-detect) | No | Number precision |
| 06-multiple-providers | Yes (auto-detect) | No | Real-world data |
| 07-collision-risk | **COLLISION** | No | Risk detection |
| 08-weekend-autopay | **WEEKEND_AUTOPAY** | No | Risk detection |

## Manual Testing Checklist

From [specs/014-build-a-csv/quickstart.md](../../specs/014-build-a-csv/quickstart.md):

- [ ] Scenario 1: Basic export (use 01-basic-payments.csv)
- [ ] Scenario 2: Empty risk data (use 02-empty-risk-data.csv)
- [ ] Scenario 3: Special characters (use 03-special-characters.csv)
- [ ] Scenario 4: Unicode (use 04-unicode-characters.csv)
- [ ] Scenario 5: Large dataset (generate 600 rows programmatically)
- [ ] Scenario 6: Round-trip (use any sample, export, re-import)
- [ ] Scenario 7: Button states (test with/without data)
- [ ] Scenario 8: Filename timestamp (verify format)
- [ ] Scenario 9: Browser compatibility (Chrome, Firefox, Safari, Edge)
- [ ] Scenario 10: Edge cases (use 05-edge-cases.csv)

## Notes

- All CSV files use UTF-8 encoding
- Windows-style line endings (CRLF) for maximum compatibility
- Files follow PayPlan import schema (lowercase headers)
- Generated: 2025-10-14 (Feature 014 - CSV Export)
