# Delta 0022.3 — OpenAPI v1 LOC Guard (Non-blocking)

## Summary

Adds non-blocking OpenAPI LOC guard; whitespace/format-only enforcement; no semantic drift.

## Scope

Docs/CI only. `api/openapi.yaml` fixed at 173 LOC. Spectral 0 errors / 0 warnings.

## What Changed

- **New file**: `scripts/openapi-loc-guard.mjs` (29 LOC, Node 20 built-ins only)
- **Modified**: `.github/workflows/pr-hygiene.yml` (+6 lines) — new CI step
- **No spec edits**: `api/openapi.yaml` unchanged at 173 LOC

## Verification

```bash
wc -l api/openapi.yaml        # expect 173
node scripts/openapi-loc-guard.mjs --max 180 --target 120
node scripts/openapi-loc-guard.mjs --max 172 --target 120 || echo "expected fail path"
npx -y @stoplight/spectral-cli lint api/openapi.yaml
```

## Risk

None; non-blocking CI; fully reversible.

## Rollback

```bash
git revert <merge-commit>
```

## Metrics

| Metric            | Value |
|-------------------|-------|
| Current LOC       | 173   |
| Max               | 180   |
| Target            | 120   |
| Spectral          | 0/0   |
| Files touched     | 2     |

## Appendix

### Sample Output (PASS)

```
OPENAPI_LOC=173
OPENAPI_BUDGET_MAX=180, TARGET=120
## OpenAPI LOC Guard
- Current: 173
- Max: 180
- Target: 120
- Status: PASS
```

### Sample Output (FAIL)

```
OPENAPI_LOC=173
OPENAPI_BUDGET_MAX=172, TARGET=120
## OpenAPI LOC Guard
- Current: 173
- Max: 172
- Target: 120
- Status: FAIL
```

### CI Step

```yaml
- name: OpenAPI LOC Guard (non-blocking)
  if: steps.detect.outputs.path != ''
  continue-on-error: true
  run: |
    node scripts/openapi-loc-guard.mjs --max 180 --target 120 | tee -a "$GITHUB_STEP_SUMMARY"
```
